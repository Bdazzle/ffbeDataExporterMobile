{"ast":null,"code":"var _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _exportNames = {\n  Appearance: true,\n  AppearanceProvider: true,\n  useColorScheme: true\n};\nexports.useColorScheme = useColorScheme;\nexports.AppearanceProvider = exports.Appearance = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _fbemitter = require(\"fbemitter\");\n\nvar _useSubscription = require(\"use-subscription\");\n\nvar _Appearance = require(\"./Appearance.types\");\n\nObject.keys(_Appearance).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _Appearance[key];\n    }\n  });\n});\n\nvar _NativeAppearance = require(\"./NativeAppearance\");\n\nvar _jsxFileName = \"/Users/brentvatne/code/react-native-appearance/src/index.tsx\";\nvar eventEmitter = new _fbemitter.EventEmitter();\nvar appearancePreferences = _NativeAppearance.NativeAppearance.initialPreferences;\nvar nativeEventEmitter = new _reactNative.NativeEventEmitter(_NativeAppearance.NativeAppearance);\nnativeEventEmitter.addListener('appearanceChanged', function (newAppearance) {\n  Appearance.set(newAppearance);\n});\n\nvar Appearance = function () {\n  function Appearance() {\n    (0, _classCallCheck2.default)(this, Appearance);\n  }\n\n  (0, _createClass2.default)(Appearance, null, [{\n    key: \"getColorScheme\",\n    value: function getColorScheme() {\n      return appearancePreferences.colorScheme;\n    }\n  }, {\n    key: \"set\",\n    value: function set(preferences) {\n      var colorScheme = preferences.colorScheme;\n\n      if (appearancePreferences.colorScheme !== colorScheme) {\n        appearancePreferences = {\n          colorScheme: colorScheme\n        };\n        eventEmitter.emit('change', preferences);\n      }\n    }\n  }, {\n    key: \"addChangeListener\",\n    value: function addChangeListener(listener) {\n      return eventEmitter.addListener('change', listener);\n    }\n  }]);\n  return Appearance;\n}();\n\nexports.Appearance = Appearance;\n\nvar AppearanceProvider = function AppearanceProvider(props) {\n  return _react.default.createElement(_NativeAppearance.NativeAppearanceProvider, (0, _extends2.default)({\n    style: {\n      flex: 1\n    }\n  }, props, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    }\n  }));\n};\n\nexports.AppearanceProvider = AppearanceProvider;\n\nfunction useColorScheme() {\n  var subscription = (0, _react.useMemo)(function () {\n    return {\n      getCurrentValue: function getCurrentValue() {\n        return Appearance.getColorScheme();\n      },\n      subscribe: function subscribe(callback) {\n        var eventSubscription = Appearance.addChangeListener(callback);\n        return function () {\n          return eventSubscription.remove();\n        };\n      }\n    };\n  }, []);\n  return (0, _useSubscription.useSubscription)(subscription);\n}","map":{"version":3,"sources":["index.tsx"],"names":["eventEmitter","appearancePreferences","NativeAppearance","nativeEventEmitter","Appearance","colorScheme","preferences","AppearanceProvider","flex","subscription","useMemo","getCurrentValue","subscribe","eventSubscription","useSubscription"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAGA;;;AAGA,IAAMA,YAAY,GAAG,IAArB,uBAAqB,EAArB;AAGA,IAAIC,qBAA4C,GAAGC,mCAAnD,kBAAA;AAGA,IAAMC,kBAAkB,GAAG,IAAA,+BAAA,CAA3B,kCAA2B,CAA3B;AACAA,kBAAkB,CAAlBA,WAAAA,CAAAA,mBAAAA,EAAoD,UAAA,aAAA,EAA0C;AAC5FC,EAAAA,UAAU,CAAVA,GAAAA,CAAAA,aAAAA;AADFD,CAAAA;;AAIA,IAAaC,UAAb,GAAA,YAAA;AAAA,WAAA,UAAA,GAAA;AAAA,kCAAA,IAAA,EAAA,UAAA;AAAA;;AAAA,6BAAA,UAAA,EAAA,IAAA,EAAA,CAAA;AAAA,IAAA,GAAA,EAAA,gBAAA;AAAA,IAAA,KAAA,EAAA,SAAA,cAAA,GAa2C;AACvC,aAAOH,qBAAqB,CAA5B,WAAA;AAdJ;AAAA,GAAA,EAAA;AAAA,IAAA,GAAA,EAAA,KAAA;AAAA,IAAA,KAAA,EAAA,SAAA,GAAA,CAAA,WAAA,EAwBuD;AAAA,UAC7CI,WAD6C,GAC7BC,WAD6B,CAAA,WAAA;;AAInD,UAAIL,qBAAqB,CAArBA,WAAAA,KAAJ,WAAA,EAAuD;AACrDA,QAAAA,qBAAqB,GAAG;AAAEI,UAAAA,WAAW,EAArCJ;AAAwB,SAAxBA;AACAD,QAAAA,YAAY,CAAZA,IAAAA,CAAAA,QAAAA,EAAAA,WAAAA;AAEH;AAhCH;AAAA,GAAA,EAAA;AAAA,IAAA,GAAA,EAAA,mBAAA;AAAA,IAAA,KAAA,EAAA,SAAA,iBAAA,CAAA,QAAA,EAqC4E;AACxE,aAAOA,YAAY,CAAZA,WAAAA,CAAAA,QAAAA,EAAP,QAAOA,CAAP;AAtCJ;AAAA,GAAA,CAAA;AAAA,SAAA,UAAA;AAAA,CAAA,EAAA;;;;AA8CO,IAAMO,kBAAkB,GAAlBA,SAAAA,kBAAAA,CAAqB,KAArBA,EAAqB;AAAA,SAChC,eAAA,aAAA,CAAA,0CAAA,EAAA,uBAAA;AAA0B,IAAA,KAAK,EAAE;AAAEC,MAAAA,IAAI,EAAvC;AAAiC;AAAjC,GAAA,EAAA,KAAA,EAAA;AAAA,IAAA,QAAA,EAAA;AAAA,MAAA,QAAA,EAAA,YAAA;AAAA,MAAA,UAAA,EADgC;AAChC;AAAA,GAAA,CAAA,CADgC;AAA3B,CAAA;;;;AAOA,SAAA,cAAA,GAA2C;AAChD,MAAMC,YAAY,GAAGC,oBACnB,YAAA;AAAA,WAAO;AACLC,MAAAA,eAAe,EAAE,SAAA,eAAA,GAAA;AAAA,eAAMP,UAAU,CAAhB,cAAMA,EAAN;AADZ,OAAA;AAELQ,MAAAA,SAAS,EAAE,SAAA,SAAA,CAAA,QAAA,EAAkC;AAC3C,YAAIC,iBAAiB,GAAGT,UAAU,CAAVA,iBAAAA,CAAxB,QAAwBA,CAAxB;AACA,eAAO,YAAA;AAAA,iBAAMS,iBAAiB,CAAvB,MAAMA,EAAN;AAAP,SAAA;AAJJ;AAAO,KAAP;AAD0B,GAAPH,EAArB,EAAqBA,CAArB;AAWA,SAAOI,sCAAP,YAAOA,CAAP;AACD","sourcesContent":["import React, { useMemo } from 'react';\nimport { NativeEventEmitter } from 'react-native';\nimport { EventEmitter, EventSubscription } from 'fbemitter';\nimport { useSubscription } from 'use-subscription';\nimport { AppearancePreferences, ColorSchemeName, AppearanceListener } from './Appearance.types';\nexport * from './Appearance.types';\n\n// Native modules\nimport { NativeAppearance, NativeAppearanceProvider } from './NativeAppearance';\n\n// Initialize the user-facing event emitter\nconst eventEmitter = new EventEmitter();\n\n// Initialize preferences synchronously\nlet appearancePreferences: AppearancePreferences = NativeAppearance.initialPreferences;\n\n// Initialize the native event emitter\nconst nativeEventEmitter = new NativeEventEmitter(NativeAppearance);\nnativeEventEmitter.addListener('appearanceChanged', (newAppearance: AppearancePreferences) => {\n  Appearance.set(newAppearance);\n});\n\nexport class Appearance {\n  /**\n   * Note: Although appearance is available immediately, it may change (e.g\n   * Dark Mode) so any rendering logic or styles that depend on this should try\n   * to call this function on every render, rather than caching the value (for\n   * example, using inline styles rather than setting a value in a\n   * `StyleSheet`).\n   *\n   * Example: `const colorScheme = Appearance.get('colorScheme');`\n   *\n   * @param {string} preference Name of preference (e.g. 'colorScheme').\n   * @returns {ColorSchemeName} Value for the preference.\n   */\n  static getColorScheme(): ColorSchemeName {\n    return appearancePreferences.colorScheme;\n  }\n\n  /**\n   * This should only be called from native code by sending the\n   * appearanceChanged event.\n   *\n   * @param {object} appearancePreferences Simple string-keyed object of\n   * appearance preferences to set.\n   */\n  static set(preferences: AppearancePreferences): void {\n    let { colorScheme } = preferences;\n\n    // Don't bother emitting if it's the same value\n    if (appearancePreferences.colorScheme !== colorScheme) {\n      appearancePreferences = { colorScheme };\n      eventEmitter.emit('change', preferences);\n    }\n  }\n\n  /**\n   * Add an event handler that is fired when appearance preferences change.\n   */\n  static addChangeListener(listener: AppearanceListener): EventSubscription {\n    return eventEmitter.addListener('change', listener);\n  }\n}\n\n/**\n * Temporarily require a Provider since the upstream implementation uses root view customizations\n * to accomplish this same behavior\n */\nexport const AppearanceProvider = (props: { children: any }) => (\n  <NativeAppearanceProvider style={{ flex: 1 }} {...props} />\n);\n\n/**\n * Subscribe to color scheme updates\n */\nexport function useColorScheme(): ColorSchemeName {\n  const subscription = useMemo(\n    () => ({\n      getCurrentValue: () => Appearance.getColorScheme(),\n      subscribe: (callback: AppearanceListener) => {\n        let eventSubscription = Appearance.addChangeListener(callback);\n        return () => eventSubscription.remove();\n      },\n    }),\n    [],\n  );\n\n  return useSubscription<ColorSchemeName>(subscription);\n}\n"]},"metadata":{},"sourceType":"script"}